# 自述

用了FOR和IF结构，其基本思路是用xlwings读取excel文件，再用Python操作键盘鼠标，代替人工把数据录入用友财务软件T3里，每天只需要制作好Excel表格，运行脚本，就可以让电脑代替手工操作，能节约很多时间。当然，为什么要做这个，是因为要导入Excel表格的话，需要专门购买接口，用友报价一个要7000元以上。所以以下这段代码是非常有价值的。

首先，我们先准备好EXCEL文件——凭证录入模块.xlsx及工作表“录入分录明细”，其格式如下：

![模块](https://user-images.githubusercontent.com/57973589/124345906-5645cd00-dc0e-11eb-9570-eb685334bcf5.png)

然后再准备用友T3，打开总账模块，选择填制凭证

![T3](https://user-images.githubusercontent.com/57973589/124345917-6cec2400-dc0e-11eb-9d4c-8256a08f0737.jpg)

import pyautogui as pag ，这个是引用pyautogui库，其功能是：根据屏幕分辨率的坐标模拟鼠标移动，模拟鼠标点击，包括鼠标左击，右击，双击，拖拽等等。

也支持键盘按键和英文输入，但不支持中文输入。在这段代码里主要是用来操控键盘鼠标把Excel中的值输入财务软件T3里。

小程序有两个，一个是科目如果设置了辅助核算，一个是科目没有设置辅助核算的。Excel模版也有两个，分别对应两个不同的小程序。
